:root {
  --glass-bg: rgba(255,255,255,0.6);
  --glass-border: rgba(0,0,0,0.06);
  /* Earth-inspired palette */
  --brand-primary: #8a7a5c; /* taupe */
  --brand-secondary: #c97a40; /* terra */
  --brand-accent: #6b8f71; /* sage */
  --brand-primary-rgb: 138, 122, 92;
  --brand-secondary-rgb: 201, 122, 64;
  --particles-color: rgba(201, 122, 64, 0.55);
  --text-secondary: #6c757d;
  --header-offset: 72px;
  --tabbar-h: 0px;
  /* Bootstrap color overrides */
  --bs-primary: var(--brand-secondary);
  --bs-primary-rgb: var(--brand-secondary-rgb);
  --bs-link-color: var(--brand-secondary);
  --bs-link-hover-color: var(--brand-primary);
  /* Neutral surfaces (light) */
  --surface-1: #ffffff;
  --surface-2: #f8f9fa;
  --surface-3: #f1f3f5;
}

[data-bs-theme="dark"] {
  --glass-bg: rgba(0,0,0,0.3);
  --glass-border: rgba(255,255,255,0.08);
  /* Slightly warmer earth tones for dark */
  --brand-primary: #d6b98f; /* warm sand */
  --brand-secondary: #a96b3c; /* burnt clay */
  --brand-accent: #8fbf9e; /* soft sage */
  --brand-primary-rgb: 214, 185, 143;
  --brand-secondary-rgb: 169, 107, 60;
  --particles-color: rgba(214, 185, 143, 0.55);
  --text-secondary: #adb5bd;
  --bs-primary: var(--brand-secondary);
  --bs-primary-rgb: var(--brand-secondary-rgb);
  --bs-link-color: var(--brand-secondary);
  --bs-link-hover-color: var(--brand-primary);
  /* Neutral surfaces (dark, warm charcoal) */
  --surface-1: #101312;
  --surface-2: #141817;
  --surface-3: #1a1f1d;
  /* Apply to Bootstrap tokens for cohesive background */
  --bs-body-bg: var(--surface-1);
  --bs-body-color: #e8ecea;
  --bs-card-bg: var(--surface-2);
  --bs-border-color: rgba(255,255,255,0.08);
}

/* Dark tone variants */
[data-bs-theme="dark"][data-tone="warm"] {
  --surface-1: #101312;
  --surface-2: #141817;
  --surface-3: #1a1f1d;
}
[data-bs-theme="dark"][data-tone="cool"] {
  --surface-1: #0f1216; /* graphite */
  --surface-2: #141923;
  --surface-3: #1a2130;
}

.glass {
  backdrop-filter: saturate(180%) blur(8px);
  background: var(--glass-bg) !important;
}

.card-hover:hover {
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
  transform: translateY(-1px);
  transition: all .2s ease;
}

.gradient-text {
  background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary));
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

.avatar-frame .avatar { border-radius: 50%; display: block; width: 100%; height: 100%; object-fit: cover; }

.page-hero {
  border: 1px solid var(--glass-border);
  border-radius: .75rem;
  background-color: var(--surface-2);
}

.section + .section { margin-top: 1.25rem; }

/* Elevation */
.card-elevate { box-shadow: inset 0 0 0 1px var(--glass-border), 0 10px 30px rgba(0,0,0,.06); }
[data-bs-theme="dark"] .card-elevate { box-shadow: inset 0 0 0 1px var(--glass-border), 0 10px 20px rgba(0,0,0,.35); }

/* Sidebar polish */
.sidebar.sticky-top { top: var(--header-offset); }
.sidebar .profile-card .avatar-frame { position: relative; display: inline-grid; place-items: center; width: 64px; height: 64px; border-radius: 50%; padding: 0; background: transparent; border: 1px solid var(--glass-border); box-shadow: none; overflow: hidden; }
.sidebar .profile-card .avatar-frame .avatar { display: block; width: 100%; height: 100%; object-fit: cover; object-position: center; border: none; border-radius: 50%; background: transparent; }
.sidebar .letter { letter-spacing: .06em; }

/* Mobile section chips (quick nav) */
@media (max-width: 575.98px) {
  .sidebar .section-chips { position: sticky; top: var(--header-offset); z-index: 1099; background: var(--bs-body-bg); border-bottom: 1px solid var(--glass-border); margin: 0 -0.5rem 0.5rem; padding: 0.35rem; }
  .sidebar .chips-row { display: flex; gap: .35rem; overflow-x: auto; -webkit-overflow-scrolling: touch; scroll-snap-type: x proximity; }
  .sidebar .chip { flex: 0 0 auto; scroll-snap-align: center; display: inline-flex; align-items: center; gap: .35rem; padding: .28rem .5rem; border-radius: 999px; border: 1px solid var(--glass-border); color: inherit; text-decoration: none; background: var(--surface-2); font-size: .85rem; }
  [data-bs-theme="dark"] .sidebar .chip { background: var(--surface-2); }
  .sidebar .chip .chip-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--brand-primary); opacity: .7; }
  .sidebar .chip.active { background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary)); color: #fff; border-color: transparent; }
  .sidebar .chip.active .chip-dot { background: #fff; opacity: 1; }
}

@media (max-width: 380px) {
  .sidebar .chip { font-size: .78rem; padding: .24rem .45rem; gap: .3rem; }
  .sidebar .chip .chip-dot { width: 5px; height: 5px; }
}

/* Spy list improvements */
.spy-list { position: relative; }
.spy-item { position: relative; display: flex; align-items: center; gap: .5rem; padding: .35rem .5rem .35rem .75rem; border-radius: .5rem; color: inherit; text-decoration: none; opacity: .85; transition: background .15s ease, opacity .15s ease; }
.spy-item .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--brand-primary); opacity: .5; }
.spy-item:hover { background: rgba(0,0,0,.04); opacity: 1; }
[data-bs-theme="dark"] .spy-item:hover { background: rgba(255,255,255,.05); }
.spy-item.active { opacity: 1; font-weight: 600; }
.spy-item.active .dot { background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary)); opacity: 1; }
.spy-item.active::before { content: ''; position: absolute; left: -8px; top: 0; bottom: 0; width: 3px; border-radius: 3px; background: linear-gradient(180deg, var(--brand-primary), var(--brand-secondary)); }

/* Social grid */
.social-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: .5rem; }
.icon-btn { height: 36px; width: 36px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center; }
.icon-btn i { transition: color .15s ease; }
.icon-btn[data-brand="linkedin"]:hover i { color: #0a66c2; }
.icon-btn[data-brand="github"]:hover i { color: #181717; }
[data-bs-theme="dark"] .icon-btn[data-brand="github"]:hover i { color: #f0f6fc; }
.icon-btn[data-brand="email"]:hover i { color: var(--brand-primary); }
.icon-btn[data-brand="scholar"]:hover i { color: #4285f4; }

/* Mini GitHub stats */
.mini-stats { display: flex; gap: .5rem; }
.stat-chip { display: inline-flex; align-items: center; gap: .25rem; font-size: .8125rem; padding: .2rem .5rem; border-radius: .5rem; border: 1px solid var(--glass-border); background: var(--glass-bg); }

/* Smooth scroll and selection */
html { scroll-behavior: smooth; }
::selection { background: rgba(var(--brand-secondary-rgb), 0.25); }

/* Scroll progress */
.scroll-progress {
  position: fixed;
  top: 0; left: 0; height: 3px;
  background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary));
  z-index: 1100;
  transition: width .1s ease-out;
}

/* Particles canvas in hero */
.hero-with-bg { background: radial-gradient(1200px 600px at 20% -20%, rgba(var(--brand-primary-rgb), .14), transparent), radial-gradient(1000px 400px at 120% 20%, rgba(var(--brand-secondary-rgb), .14), transparent); }
[data-bs-theme="dark"] .hero-with-bg { background: radial-gradient(1200px 600px at 20% -20%, rgba(var(--brand-primary-rgb), .08), transparent), radial-gradient(1000px 400px at 120% 20%, rgba(var(--brand-secondary-rgb), .08), transparent); }
.particles-canvas { position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; opacity: .55; }

/* Reveal animations */
[data-animate] { opacity: 0; transform: translateY(12px); transition: opacity .6s ease, transform .6s ease; will-change: opacity, transform; }
[data-animate].is-visible { opacity: 1; transform: translateY(0); }

@media (prefers-reduced-motion: reduce) {
  [data-animate] { opacity: 1 !important; transform: none !important; transition: none !important; }
  .badge-glow, .badge-pulse { animation: none !important; }
  .badge-pulse::after { display: none !important; }
  .tilt { transition: none !important; transform: none !important; }
}

/* Typewriter */
.typewriter .caret { display: inline-block; width: 1ch; color: var(--text-secondary); animation: blink 1s step-end infinite; }
@keyframes blink { 50% { opacity: 0; } }

/* Tilt effect */
.tilt { transition: transform .12s ease-out; transform-style: preserve-3d; will-change: transform; }
.tilt .card { background-image: radial-gradient(circle at var(--tilt-glare-x, 50%) var(--tilt-glare-y, 50%), rgba(255,255,255,0.08), transparent 35%); }

/* Badges microinteraction */
.badge-glow { background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary)); color: #fff; box-shadow: 0 0 0 rgba(var(--brand-primary-rgb),0); animation: glow 3s ease-in-out infinite; }
@keyframes glow { 0%,100% { box-shadow: 0 0 0 rgba(var(--brand-primary-rgb),0);} 50% { box-shadow: 0 0 14px rgba(var(--brand-primary-rgb),0.35);} }
.badge-pulse { position: relative; overflow: hidden; }
.badge-pulse::after { content: ''; position: absolute; inset: 0; background: radial-gradient(circle at 120% -20%, rgba(255,255,255,0.4), transparent 45%); transform: translateX(-120%); animation: shine 5s linear infinite; }
@keyframes shine { 0% { transform: translateX(-120%);} 100% { transform: translateX(120%);} }

/* Timeline */
.timeline { position: relative; margin-left: .75rem; padding-left: 1.25rem; }
.timeline::before { content: ''; position: absolute; top: 0; bottom: 0; left: 0; width: 2px; background: var(--glass-border); }
[data-bs-theme="dark"] .timeline::before { background: rgba(255,255,255,0.06); }
.timeline-item { position: relative; margin-bottom: 1rem; }
.timeline-dot { position: absolute; left: -4px; top: .28rem; width: 8px; height: 8px; border-radius: 50%; background: var(--brand-accent); box-shadow: 0 0 0 3px rgba(var(--brand-secondary-rgb),0.22); }
[data-bs-theme="dark"] .timeline-dot { box-shadow: 0 0 0 3px rgba(var(--brand-secondary-rgb),0.18); }
.timeline-content { padding-left: .25rem; }

/* Toast */
.toast-container { position: fixed; right: 1rem; bottom: 1rem; z-index: 1100; opacity: 0; transform: translateY(8px); transition: all .2s ease; pointer-events: none; }
.toast-container.show { opacity: 1; transform: translateY(0); }
.toast-item { background: var(--glass-bg); border: 1px solid var(--glass-border); backdrop-filter: blur(8px); border-radius: .5rem; padding: .5rem .75rem; box-shadow: 0 4px 20px rgba(0,0,0,.12); }

/* ScrollSpy list */
.spy-list a { color: inherit; text-decoration: none; opacity: .7; }
.spy-list a.active { opacity: 1; font-weight: 600; }
.spy-list .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--brand-primary); opacity: .6; }
.spy-list a.active .dot { opacity: 1; }

/* Project preview overlay */
.project-card { position: relative; overflow: hidden; }
.project-card .project-preview { position: absolute; inset: 0; opacity: 0; transition: opacity .25s ease; background: radial-gradient(circle at 30% 20%, rgba(var(--brand-primary-rgb), .10), transparent 40%), radial-gradient(circle at 80% 80%, rgba(var(--brand-secondary-rgb), .12), transparent 40%); }
.project-card:hover .project-preview { opacity: 1; }
.project-card .project-preview img { width: 100%; height: 100%; object-fit: cover; opacity: .85; }

/* Portrait in hero */
.portrait { max-height: 360px; height: auto; width: auto; position: relative; z-index: 1; }
@media (max-width: 575.98px) { .portrait { max-height: 260px; } }

/* Soft vignette behind portrait */
.portrait-wrap { position: relative; display: inline-block; }
.portrait-wrap::before { content: ''; position: absolute; inset: -12%; z-index: 0; border-radius: 20px; filter: blur(26px); opacity: .85;
  background:
    radial-gradient(closest-side, rgba(var(--brand-primary-rgb), .18), transparent 60%),
    radial-gradient(closest-side, rgba(var(--brand-secondary-rgb), .18), transparent 65%);
}

/* Blur-up image loading */
.blur-up { filter: blur(12px); transform: scale(1.02); opacity: .9; transition: filter .5s ease, transform .5s ease, opacity .4s ease; }
.blur-up.loaded { filter: blur(0); transform: none; opacity: 1; }

/* MDX prose styles */
.prose { line-height: 1.7; }
.prose h1, .prose h2, .prose h3 { margin-top: 1.2em; margin-bottom: .5em; }
.prose p { margin-bottom: 1em; color: var(--text-secondary); }
.prose code { background: rgba(0,0,0,.06); padding: .2em .35em; border-radius: .35em; }
[data-bs-theme="dark"] .prose code { background: rgba(255,255,255,.06); }
.prose pre { background: rgba(0,0,0,.06); padding: 1em; border-radius: .5em; overflow: auto; }
[data-bs-theme="dark"] .prose pre { background: rgba(255,255,255,.06); }
.prose blockquote { border-left: 3px solid var(--brand-primary); padding-left: 1em; color: var(--text-secondary); margin: 1em 0; }

/* Social grid responsive */
@media (max-width: 575.98px) {
  .social-grid { grid-template-columns: repeat(3, 1fr); }
}
.icon-row { display: flex; gap: .5rem; flex-wrap: wrap; }
.icon-btn { width: 38px; height: 38px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center; }
.icon-btn i, .icon-btn span { font-size: 1rem; }
.icon-k { font-weight: 700; letter-spacing: .5px; background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary)); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }

/* Mobile: lighten heavy effects for smoother scrolling */
@media (max-width: 575.98px) {
  .glass { backdrop-filter: none; }
  .card-elevate { box-shadow: inset 0 0 0 1px var(--glass-border), 0 6px 16px rgba(0,0,0,.05); }
  .hero-with-bg { background: radial-gradient(800px 400px at 10% -10%, rgba(var(--brand-primary-rgb), .10), transparent); }
}

/* Mobile nav drawer */
.mobile-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.35); border: 0; padding: 0; margin: 0; z-index: 2000; }
.mobile-drawer { position: fixed; right: 0; top: 0; bottom: 0; width: min(86vw, 380px); background: var(--bs-body-bg); border-left: 1px solid var(--glass-border); z-index: 2001; display: flex; flex-direction: column; padding: max(env(safe-area-inset-top, 16px), 16px) 16px 16px; }
.mobile-drawer-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: .5rem; }
.mobile-link { display: flex; align-items: center; gap: .5rem; padding: .6rem .25rem; color: inherit; text-decoration: none; border-radius: .5rem; }
.mobile-link:hover { background: rgba(0,0,0,.04); }
[data-bs-theme="dark"] .mobile-link:hover { background: rgba(255,255,255,.05); }
.mobile-link.active { background: rgba(var(--brand-primary-rgb), .12); }
[data-bs-theme="dark"] .mobile-link.active { background: rgba(var(--brand-secondary-rgb), .16); }

/* Desktop nav active highlight */
.nav-highlight { position: absolute; inset: 0.2rem 0; border-radius: .5rem; background: rgba(var(--brand-primary-rgb), .12); z-index: 0; }
[data-bs-theme="dark"] .nav-highlight { background: rgba(var(--brand-secondary-rgb), .16); }
/* Ensure nav label is above highlight */
.nav-link > span > span { position: relative; z-index: 1; }

/* Sidebar should not be sticky on small screens to avoid conflicts with mobile navbar */
@media (max-width: 991.98px) {
  .sidebar.sticky-top { position: static !important; top: auto !important; }
}

/* Navbar minor polish */
.navbar .nav-link { font-weight: 500; }
.navbar .nav-link:hover { color: var(--brand-primary); }

/* Header auto-hide on mobile */
.header-auto { transition: transform .25s ease; will-change: transform; z-index: 1204; }
.header-hidden { transform: translateY(calc(-100% - 1px)); }
@media (min-width: 768px) { .header-hidden { transform: none !important; } }

/* CV hero refinements */
.cv-hero { position: relative; }
.cv-hero::after { content: ''; position: absolute; inset: -10%; pointer-events: none; background:
  radial-gradient(800px 400px at 10% -10%, rgba(var(--brand-primary-rgb), .12), transparent 60%),
  radial-gradient(600px 320px at 110% 10%, rgba(var(--brand-secondary-rgb), .12), transparent 60%);
  filter: blur(0.2px);
}
[data-bs-theme="dark"] .cv-hero::after { background:
  radial-gradient(800px 400px at 10% -10%, rgba(var(--brand-primary-rgb), .08), transparent 60%),
  radial-gradient(600px 320px at 110% 10%, rgba(var(--brand-secondary-rgb), .08), transparent 60%);
}

/* Skill meter */
.skill-meter .meter-track { position: relative; height: 8px; background: rgba(0,0,0,.08); border-radius: 999px; overflow: hidden; }
[data-bs-theme="dark"] .skill-meter .meter-track { background: rgba(255,255,255,.08); }
.skill-meter .meter-fill { position: absolute; inset: 0 100% 0 0; background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary)); border-radius: 999px; width: var(--w, 0%); transition: width .6s ease; }

/* Back to top */
.back-to-top { position: fixed; right: 16px; bottom: 16px; z-index: 1200; }
.back-to-top .btn { box-shadow: 0 8px 20px rgba(0,0,0,.15); }

/* Mobile bottom tabbar */
@media (max-width: 767.98px) {
  :root { --header-offset: 60px; }
  :root { --tabbar-h: calc(56px + env(safe-area-inset-bottom)); }
  main.container { padding-bottom: var(--tabbar-h); }
  .mobile-tabbar {
    position: fixed; left: 0; right: 0; bottom: 0; z-index: 1202;
    height: var(--tabbar-h); padding: 8px max(env(safe-area-inset-left), 12px) max(env(safe-area-inset-bottom), 8px);
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;
    background: var(--bs-body-bg); border-top: 1px solid var(--glass-border);
    backdrop-filter: saturate(180%) blur(10px);
    transition: transform .25s ease, opacity .2s ease;
  }
  .mobile-tabbar.hidden { transform: translateY(100%); opacity: .95; }
  .mobile-tabbar .tab-link { position: relative; text-decoration: none; color: inherit; display: inline-flex; align-items: center; justify-content: center; border-radius: 12px; padding: 6px 8px; overflow: hidden; }
  .mobile-tabbar .tab-inner { position: relative; display: inline-flex; flex-direction: column; align-items: center; gap: 2px; min-width: 56px; }
  .mobile-tabbar .tab-link i { font-size: 1.1rem; }
  .mobile-tabbar .tab-link .label { font-size: .75rem; opacity: .9; }
  .mobile-tabbar .tab-highlight { position: absolute; inset: -2px -6px; border-radius: 10px; background: rgba(var(--brand-primary-rgb), .14); z-index: -1; }
  [data-bs-theme="dark"] .mobile-tabbar .tab-highlight { background: rgba(var(--brand-secondary-rgb), .18); }
}

/* Lift back-to-top above tabbar */
@media (max-width: 767.98px) { .back-to-top { bottom: calc(16px + var(--tabbar-h)); z-index: 1203; } }

/* Lift toasts above tabbar on phones */
@media (max-width: 767.98px) { .toast-container { bottom: calc(1rem + var(--tabbar-h)); } }

/* Bootstrap component overrides for Earth theme */
.btn-primary {
  --bs-btn-color: #fff;
  --bs-btn-bg: var(--brand-secondary);
  --bs-btn-border-color: var(--brand-secondary);
  --bs-btn-hover-bg: color-mix(in srgb, var(--brand-secondary), black 8%);
  --bs-btn-hover-border-color: color-mix(in srgb, var(--brand-secondary), black 12%);
  --bs-btn-active-bg: color-mix(in srgb, var(--brand-secondary), black 14%);
  --bs-btn-active-border-color: color-mix(in srgb, var(--brand-secondary), black 18%);
  --bs-btn-disabled-bg: var(--brand-secondary);
  --bs-btn-disabled-border-color: var(--brand-secondary);
}
.text-bg-primary, .badge.text-bg-primary {
  background-color: var(--brand-secondary) !important;
  color: #fff !important;
}

/* Sidebar sections active highlight */
.spy-item { position: relative; }
.spy-highlight { position: absolute; inset: 0; border-radius: .5rem; background: rgba(var(--brand-primary-rgb), .10); z-index: 0; }
[data-bs-theme="dark"] .spy-highlight { background: rgba(var(--brand-secondary-rgb), .14); }

/* Palette toggle: classic overrides */
[data-palette="classic"] {
  --brand-primary: #0d6efd;
  --brand-secondary: #6f42c1;
  --brand-accent: #20c997;
  --brand-primary-rgb: 13, 110, 253;
  --brand-secondary-rgb: 111, 66, 193;
  --particles-color: rgba(13, 110, 253, 0.55);
}
[data-bs-theme="dark"][data-palette="classic"] {
  --brand-primary: #7fb2ff;
  --brand-secondary: #9a7bd6;
  --brand-accent: #7dd6b8;
  --brand-primary-rgb: 127, 178, 255;
  --brand-secondary-rgb: 154, 123, 214;
  --particles-color: rgba(127, 178, 255, 0.55);
}

/* Ripple effect (applies to buttons/links) */
.btn, .mobile-link, .nav-link, .icon-btn { position: relative; overflow: hidden; }
.ripple-wave { position: absolute; pointer-events: none; border-radius: 999px; transform: translate(-50%, -50%) scale(0); opacity: .35; background: radial-gradient(circle, rgba(var(--brand-secondary-rgb), .35) 0%, rgba(var(--brand-secondary-rgb), .2) 40%, transparent 60%); box-shadow: 0 0 0 1px rgba(255,255,255,.2) inset; animation: ripple-wave .6s ease-out forwards; }
@keyframes ripple-wave { to { transform: translate(-50%, -50%) scale(1); opacity: 0; } }

/* Card shine + subtle border tint on hover */
.card-hover { position: relative; overflow: hidden; border-color: var(--glass-border); transition: border-color .2s ease, box-shadow .2s ease; }
.card-hover:hover { border-color: rgba(var(--brand-secondary-rgb), .28); }
.card-hover::after { content: ''; position: absolute; inset: -150% -50%; background: linear-gradient(120deg, transparent 40%, rgba(255,255,255,.22) 50%, transparent 60%); transform: translateX(-100%); opacity: 0; }
.card-hover:hover::after { opacity: 1; animation: card-shine 1s ease; }
@keyframes card-shine { from { transform: translateX(-100%);} to { transform: translateX(100%);} }
